---
title: "Scatter Plot"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(ggplot2)
library(dplyr)
library(tidyr)
knitr::opts_chunk$set(echo = FALSE)
```

## Introduction

### Agenda

<hr>

- build scatter plots
- modify point
    - color
    - fill
    - alpha
    - shape
    - size
- fit regression line


## Plot

<hr>

### Instruction

- map `x` to `disp`
- map `y` to `mpg`

```{r scat2, fig.align='center', exercise = TRUE, exercise.eval = FALSE, exercise.cap = 'Scatter Plot'}
# scatter plot of disp and mpg
```

```{r scat2-solution}
ggplot(mtcars) +
  geom_point(aes(disp, mpg))
```

## Aesthetics

<hr>

Now let us modify the aesthetics of the points. There are two ways:

- map them to variables using the `aes()` function
- specify values

## Color

<hr>

### Instructions

- map `color` to `cyl`
- map `color` to `hp`
- set `color` to `'blue'`
- set `color` to `'blue'` and `alpha` to `0.4`

```{r scat4, fig.align='center', exercise = TRUE, exercise.eval = FALSE, exercise.cap = 'Color'}
# map color to cyl
ggplot(mtcars) +
  geom_point(aes(disp, mpg, _____)

# map color to hp
ggplot(mtcars) +
  geom_point(aes(disp, mpg, _____))

# set color to 'blue'
ggplot(mtcars) +
  geom_point(aes(disp, mpg), _____)

# set color to 'blue' and alpha to 0.4
ggplot(mtcars) +
  geom_point(aes(disp, mpg), _____, _____)
```

```{r scat4-solution}
ggplot(mtcars) +
  geom_point(aes(disp, mpg, color = factor(cyl)))

ggplot(mtcars) +
  geom_point(aes(disp, mpg, color = hp))


ggplot(mtcars) +
  geom_point(aes(disp, mpg), color = 'blue')

ggplot(mtcars) +
  geom_point(aes(disp, mpg), color = 'blue', alpha = 0.4)
```


## Shape

<hr>

### Instructions

- map `shape` to `cyl`
- set `shape` to `3`

```{r scat8, fig.align='center', exercise = TRUE, exercise.eval = FALSE, exercise.cap = 'Shape'}
# map shape to cyl
ggplot(mtcars) +
  geom_point(aes(disp, mpg, _____))

# set shape to 3
ggplot(mtcars) +
  geom_point(aes(disp, mpg), ____)
```

```{r scat8-solution}
# map shape to cyl
ggplot(mtcars) +
  geom_point(aes(disp, mpg, shape = cyl))

# set shape to 3
ggplot(mtcars) +
  geom_point(aes(disp, mpg), shape = 3)
```


## Size

<hr>

### Instructions

- map `size` to `hp`
- set `size` to `3`

```{r scat10, fig.align='center', exercise = TRUE, exercise.eval = FALSE, exercise.cap = 'Shape'}
ggplot(mtcars) +
  geom_point(aes(disp, mpg, ____))

ggplot(mtcars) +
  geom_point(aes(disp, mpg), ____)
```

```{r scat10-solution}
ggplot(mtcars) +
  geom_point(aes(disp, mpg, size = hp))

ggplot(mtcars) +
  geom_point(aes(disp, mpg), size = 3)
```

## Fit Line

## Fit Line - Practice

<hr>

### Instructions

### Linear Regression

```{r aes12, fig.align='center', exercise = TRUE, exercise.eval = FALSE, exercise.cap = 'Regression Line'}
ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(_____, _____)

ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(_____, _____)

ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(_____, _____)
  

ggplot(mtcars, aes(disp, mpg)) +
  geom_abline(_____, _____)
```

```{r aes12-solution}
ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(method = 'lm', se = FALSE)

ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(method = 'lm', se = TRUE)

ggplot(mtcars, aes(disp, mpg)) +
  geom_smooth(method = 'loess', se = FALSE)

ggplot(mtcars, aes(disp, mpg)) +
  geom_abline(slope = 29.59985, intercept = -0.04122)
```